/* * PLC_UserTasks.c * * Created on: 2014-05-18T04:24:38.702-03:00 *  * This file is generated automatically by IDE4PLC. *  IDE4PLC website: http://ide4plc.wordpress.com/ *  IDE4PLC e-mail: http://ide4plc.gmail.com *//* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario. * Estas se implementan como funciones periódicas de FreeRtos * con un mutex cada una.*//* Includes */#include "PLeriC.h"	/* Las entradas y salidas fisicas del PLC son variables Globales públicas del tipo volatile */	volatile uint8_t entradas;	volatile uint8_t salidas;	/* Registros de I/O y Memoria como variables globales públicas */	PLC_1ByteRegister  I0;	PLC_1ByteRegister  Q0;	PLC_1KByteRegister M0;	extern PLC_SymbolicRegister CR;		/* Declaraciones de variables simbólicas localizadas */	/* Definiciones de funciones de tareas de freeRTOS que implementan las Tareas del PLC. */	/*---------------------------------------------------------------------------------------------------------*/void vPLeriCScanCycleTask(void *pvParameters){		/* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */			/* Cada tarea del S.O. freeRTOS contiene un bucle infinito */		for( ;; )	{			/* Lectura de las entradas físicas */		entradas = Read_IN();		I0 = Convert_Uint8_t_2_PLC_1ByteRegister(entradas);						/* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */				/* Escritura de salidas físicas */		salidas = Convert_PLC_1ByteRegister_2_Uint8_t( Q0 );		Write_OUT(salidas);			}}	/*---------------------------------------------------------------------------------------------------------*/void vPeriodicTask_TareaPer(void *pvParameters){	portTickType xLastWakeTime;	/* La variable xLastWakeTime necesita ser inicializada con el conteo actual	de ticks. Nótese que este es el único momento que se accede a esta variable.	De aquí en adelante xLastWakeTime es manejada automáticamente por la función	API vTaskDelayUntil(). */	xLastWakeTime = xTaskGetTickCount(); 	/* xTaskGetTickCount() es la función API del S.O. freeRTOS para obtener el conteo 	de Ticks del Sistema.*/		/* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */		static PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR;				/* Cada tarea del S.O. freeRTOS contiene un bucle infinito */		for( ;; )	{			/* Lectura de las entradas físicas */		entradas = Read_IN();		I0 = Convert_Uint8_t_2_PLC_1ByteRegister(entradas);						/* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */							MAIN_PROG_BOOL_VAR.E0 = I0.X.x0;		MAIN_PROG_BOOL_VAR.E1 = I0.X.x1;		MAIN_PROG_BOOL_VAR.E2 = I0.X.x2;		MAIN_PROG_BOOL_VAR.E3 = I0.X.x3;		MAIN_PROG_BOOL_VAR.E4 = I0.X.x4;		MAIN_PROG_BOOL_VAR.E5 = I0.X.x5;		MAIN_PROG_BOOL_VAR.E6 = I0.X.x6;		MAIN_PROG_BOOL_VAR.E7 = I0.X.x7;			PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );						Q0.X.x0 = MAIN_PROG_BOOL_VAR.S0;		Q0.X.x1 = MAIN_PROG_BOOL_VAR.S1;		Q0.X.x2 = MAIN_PROG_BOOL_VAR.S2;		Q0.X.x3 = MAIN_PROG_BOOL_VAR.S3;		Q0.X.x4 = MAIN_PROG_BOOL_VAR.S4;		Q0.X.x5 = MAIN_PROG_BOOL_VAR.S5;		Q0.X.x6 = MAIN_PROG_BOOL_VAR.S6;		Q0.X.x7 = MAIN_PROG_BOOL_VAR.S7;				/* Escritura de salidas físicas */		salidas = Convert_PLC_1ByteRegister_2_Uint8_t( Q0 );		Write_OUT(salidas);						/* Trarea periódica cada Xms utilizando la API del S.O. freeRTOS de Dealay 		Periódico. Se pone el parámetro en ms / portTICK_RATE_MS. */		vTaskDelayUntil( &xLastWakeTime, ( 20 / portTICK_RATE_MS ) );			}}